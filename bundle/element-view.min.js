!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.ElementView=t()}(this,function(){"use strict";var t=n;function n(e){this.listenerMap=[{},{}],e&&this.root(e),this.handle=n.prototype.handle.bind(this)}n.prototype.root=function(e){var t,n=this.listenerMap;if(this.rootElement){for(t in n[1])n[1].hasOwnProperty(t)&&this.rootElement.removeEventListener(t,this.handle,!0);for(t in n[0])n[0].hasOwnProperty(t)&&this.rootElement.removeEventListener(t,this.handle,!1)}if(!e||!e.addEventListener)return this.rootElement&&delete this.rootElement,this;for(t in this.rootElement=e,n[1])n[1].hasOwnProperty(t)&&this.rootElement.addEventListener(t,this.handle,!0);for(t in n[0])n[0].hasOwnProperty(t)&&this.rootElement.addEventListener(t,this.handle,!1);return this},n.prototype.captureForType=function(e){return-1!==["blur","error","focus","load","resize","scroll"].indexOf(e)},n.prototype.on=function(e,t,n,r){var o,i,s,a;if(!e)throw new TypeError("Invalid event type: "+e);if("function"==typeof t&&(r=n,n=t,t=null),void 0===r&&(r=this.captureForType(e)),"function"!=typeof n)throw new TypeError("Handler must be a type of Function");return o=this.rootElement,(i=this.listenerMap[r?1:0])[e]||(o&&o.addEventListener(e,this.handle,r),i[e]=[]),s=t?/^[a-z]+$/i.test(t)?(a=t,h):/^#[a-z0-9\-_]+$/i.test(t)?(a=t.slice(1),u):(a=t,l):(a=null,function(e,t){return this.rootElement===window?t===document:this.rootElement===t}.bind(this)),i[e].push({selector:t,handler:n,matcher:s,matcherParam:a}),this},n.prototype.off=function(e,t,n,r){var o,i,s,a,l;if("function"==typeof t&&(r=n,n=t,t=null),void 0===r)return this.off(e,t,n,!0),this.off(e,t,n,!1),this;if(s=this.listenerMap[r?1:0],!e){for(l in s)s.hasOwnProperty(l)&&this.off(l,t,n);return this}if(!(a=s[e])||!a.length)return this;for(o=a.length-1;0<=o;o--)i=a[o],t&&t!==i.selector||n&&n!==i.handler||a.splice(o,1);return a.length||(delete s[e],this.rootElement&&this.rootElement.removeEventListener(e,this.handle,r)),this},n.prototype.handle=function(e){var t,n,r,o,i,s,a=e.type,l=[],h="ftLabsDelegateIgnore";if(!0!==e[h]){switch(3===(s=e.target).nodeType&&(s=s.parentNode),r=this.rootElement,e.eventPhase||(e.target!==e.currentTarget?3:2)){case 1:l=this.listenerMap[1][a];break;case 2:this.listenerMap[0]&&this.listenerMap[0][a]&&(l=l.concat(this.listenerMap[0][a])),this.listenerMap[1]&&this.listenerMap[1][a]&&(l=l.concat(this.listenerMap[1][a]));break;case 3:l=this.listenerMap[0][a]}for(n=l.length;s&&n;){for(t=0;t<n&&(o=l[t]);t++)if(o.matcher.call(s,o.matcherParam,s)&&(i=this.fire(e,s,o)),!1===i)return e[h]=!0,void e.preventDefault();if(s===r)break;n=l.length,s=s.parentElement}}},n.prototype.fire=function(e,t,n){return n.handler.call(t,e,t)};var l=function(e){if(e){var t=e.prototype;return t.matches||t.matchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector}}(Element);function h(e,t){return e.toLowerCase()===t.tagName.toLowerCase()}function u(e,t){return e===t.id}n.prototype.destroy=function(){this.off(),this.root()};function e(e){return new t(e)}e.Delegate=t;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};"function"==typeof Symbol&&Symbol.asyncIterator&&(r.prototype[Symbol.asyncIterator]=function(){return this}),r.prototype.next=function(e){return this._invoke("next",e)},r.prototype.throw=function(e){return this._invoke("throw",e)},r.prototype.return=function(e){return this._invoke("return",e)};function f(e){this.value=e}function r(o){var i,s;function a(e,t){try{var n=o[e](t),r=n.value;r instanceof f?Promise.resolve(r.value).then(function(e){a("next",e)},function(e){a("throw",e)}):l(n.done?"return":"normal",n.value)}catch(e){l("throw",e)}}function l(e,t){switch(e){case"return":i.resolve({value:t,done:!0});break;case"throw":i.reject(t);break;default:i.resolve({value:t,done:!1})}(i=i.next)?a(i.key,i.arg):s=null}this._invoke=function(r,o){return new Promise(function(e,t){var n={key:r,arg:o,resolve:e,reject:t,next:null};s?s=s.next=n:(i=s=n,a(r,o))})},"function"!=typeof o.return&&(this.return=void 0)}var o=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"view";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),this._listenerContext=t,this._root=e,this._delegate=new a.Delegate(e),this._attachListeners(this.events)}return o(a,[{key:"events",get:function(){return{}}},{key:"delegate",get:function(){return this._delegate}},{key:"root",get:function(){return this._root}}],[{key:"Delegate",get:function(){return e.Delegate}}]),o(a,[{key:"resetEvents",value:function(){this._delegate.off(),this._attachListeners(this.events)}},{key:"_attachListeners",value:function(e,t){var o=this,n=1<arguments.length&&void 0!==t?t:null;for(var i in e)e.hasOwnProperty(i)&&function(){var r=e[i];switch(void 0===r?"undefined":s(r)){case"function":null===n?o._delegate.on(i,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];r.apply(o._getListenerContext(),t)}):"string"==typeof n&&o._delegate.on(i,n,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];r.apply(o._getListenerContext(),t)});break;case"object":null===n&&o._attachListeners(r,i)}}()}},{key:"_getListenerContext",value:function(){var e=void 0;switch(this._listenerContext){case"view":e=this;break;case"root":e=this.root;break;case"host":e=this.root.host;break;default:e=this}return e}}]),a});
//# sourceMappingURL=element-view.min.js.map
