!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.ElementView=e()}(this,function(){"use strict";function t(e){this.listenerMap=[{},{}],e&&this.root(e),this.handle=t.prototype.handle.bind(this)}function e(t,e){return t.toLowerCase()===e.tagName.toLowerCase()}function n(t,e){return t===e.id}var r=t;t.prototype.root=function(t){var e,n=this.listenerMap;if(this.rootElement){for(e in n[1])n[1].hasOwnProperty(e)&&this.rootElement.removeEventListener(e,this.handle,!0);for(e in n[0])n[0].hasOwnProperty(e)&&this.rootElement.removeEventListener(e,this.handle,!1)}if(!t||!t.addEventListener)return this.rootElement&&delete this.rootElement,this;this.rootElement=t;for(e in n[1])n[1].hasOwnProperty(e)&&this.rootElement.addEventListener(e,this.handle,!0);for(e in n[0])n[0].hasOwnProperty(e)&&this.rootElement.addEventListener(e,this.handle,!1);return this},t.prototype.captureForType=function(t){return-1!==["blur","error","focus","load","resize","scroll"].indexOf(t)},t.prototype.on=function(t,r,i,s){var a,l,h,u;if(!t)throw new TypeError("Invalid event type: "+t);if("function"==typeof r&&(s=i,i=r,r=null),void 0===s&&(s=this.captureForType(t)),"function"!=typeof i)throw new TypeError("Handler must be a type of Function");return a=this.rootElement,(l=this.listenerMap[s?1:0])[t]||(a&&a.addEventListener(t,this.handle,s),l[t]=[]),r?/^[a-z]+$/i.test(r)?(u=r,h=e):/^#[a-z0-9\-_]+$/i.test(r)?(u=r.slice(1),h=n):(u=r,h=o):(u=null,h=function(t,e){return this.rootElement===window?e===document:this.rootElement===e}.bind(this)),l[t].push({selector:r,handler:i,matcher:h,matcherParam:u}),this},t.prototype.off=function(t,e,n,r){var o,i,s,a,l;if("function"==typeof e&&(r=n,n=e,e=null),void 0===r)return this.off(t,e,n,!0),this.off(t,e,n,!1),this;if(s=this.listenerMap[r?1:0],!t){for(l in s)s.hasOwnProperty(l)&&this.off(l,e,n);return this}if(!(a=s[t])||!a.length)return this;for(o=a.length-1;o>=0;o--)i=a[o],e&&e!==i.selector||n&&n!==i.handler||a.splice(o,1);return a.length||(delete s[t],this.rootElement&&this.rootElement.removeEventListener(t,this.handle,r)),this},t.prototype.handle=function(t){var e,n,r,o,i,s,a=t.type,l=[],h="ftLabsDelegateIgnore";if(!0!==t[h]){switch(3===(s=t.target).nodeType&&(s=s.parentNode),r=this.rootElement,t.eventPhase||(t.target!==t.currentTarget?3:2)){case 1:l=this.listenerMap[1][a];break;case 2:this.listenerMap[0]&&this.listenerMap[0][a]&&(l=l.concat(this.listenerMap[0][a])),this.listenerMap[1]&&this.listenerMap[1][a]&&(l=l.concat(this.listenerMap[1][a]));break;case 3:l=this.listenerMap[0][a]}for(n=l.length;s&&n;){for(e=0;e<n&&(o=l[e]);e++)if(o.matcher.call(s,o.matcherParam,s)&&(i=this.fire(t,s,o)),!1===i)return t[h]=!0,void t.preventDefault();if(s===r)break;n=l.length,s=s.parentElement}}},t.prototype.fire=function(t,e,n){return n.handler.call(e,t,e)};var o=function(t){if(t){var e=t.prototype;return e.matches||e.matchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector}}(Element);t.prototype.destroy=function(){this.off(),this.root()};var i=function(t){return new r(t)};i.Delegate=r;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=(function(){function t(t){this.value=t}function e(e){function n(o,i){try{var s=e[o](i),a=s.value;a instanceof t?Promise.resolve(a.value).then(function(t){n("next",t)},function(t){n("throw",t)}):r(s.done?"return":"normal",s.value)}catch(t){r("throw",t)}}function r(t,e){switch(t){case"return":o.resolve({value:e,done:!0});break;case"throw":o.reject(e);break;default:o.resolve({value:e,done:!1})}(o=o.next)?n(o.key,o.arg):i=null}var o,i;this._invoke=function(t,e){return new Promise(function(r,s){var a={key:t,arg:e,resolve:r,reject:s,next:null};i?i=i.next=a:(o=i=a,n(t,e))})},"function"!=typeof e.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(t){return this._invoke("next",t)},e.prototype.throw=function(t){return this._invoke("throw",t)},e.prototype.return=function(t){return this._invoke("return",t)}}(),function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();return function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"view";a(this,t),this._listenerContext=n,this._root=e,this._delegate=new t.Delegate(e),this._attachListeners(this.events)}return l(t,[{key:"events",get:function(){return{}}},{key:"delegate",get:function(){return this._delegate}},{key:"root",get:function(){return this._root}}],[{key:"Delegate",get:function(){return i.Delegate}}]),l(t,[{key:"resetEvents",value:function(){this._delegate.off(),this._attachListeners(this.events)}},{key:"_attachListeners",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;for(var r in t)t.hasOwnProperty(r)&&function(){var o=t[r];switch(void 0===o?"undefined":s(o)){case"function":null===n?e._delegate.on(r,function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];o.apply(e._getListenerContext(),n)}):"string"==typeof n&&e._delegate.on(r,n,function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];o.apply(e._getListenerContext(),n)});break;case"object":null===n&&e._attachListeners(o,r)}}()}},{key:"_getListenerContext",value:function(){var t=void 0;switch(this._listenerContext){case"view":t=this;break;case"root":t=this.root;break;case"host":t=this.root.host;break;default:t=this}return t}}]),t}()});
//# sourceMappingURL=element-view.min.js.map
